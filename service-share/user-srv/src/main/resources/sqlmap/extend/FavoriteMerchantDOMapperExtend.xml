<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.lawu.eshop.user.srv.mapper.extend.FavoriteMerchantDOMapperExtend" >
  <resultMap id="BaseResultMap" type="com.lawu.eshop.user.srv.domain.extend.FavoriteMerchantDOView" >
  	<result column="merchant_id" property="merchantId" jdbcType="BIGINT" />
    <result column="name" property="name" jdbcType="VARCHAR" />
    <result column="longitude" property="longitude" jdbcType="DECIMAL" />
    <result column="latitude" property="latitude" jdbcType="DECIMAL" />
    <result column="industry_name" property="industryName" jdbcType="VARCHAR" />
    <result column="feedback_rate" property="feedbackRate" jdbcType="DECIMAL" />
  </resultMap>

  <select resultMap="BaseResultMap" parameterType="com.lawu.eshop.user.srv.domain.extend.FavoriteMerchantDOView" id="selectFavoriteMerchantByRowbounds" >
    SELECT distinct(FM.id),
    	   FM.merchant_id,
    	   MS.`name`,
    	   MS.industry_name,
           MS.latitude ,
           MS.longitude,
           MS.feedback_rate
       FROM favorite_merchant FM 
	LEFT JOIN merchant_store MS ON FM.merchant_id=MS.merchant_id 
	LEFT JOIN merchant_store_profile MSP ON FM.merchant_id=MSP.merchant_id  
	WHERE  FM.member_id=#{memberId,jdbcType=BIGINT} AND MSP.manage_type=#{type,jdbcType=TINYINT}
  </select>
</mapper>